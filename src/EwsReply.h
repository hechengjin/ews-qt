/*
 * Copyright (C) 2013 Daniel Nicoletti <dantti12@gmail.com>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Library General Public
 * License as published by the Free Software Foundation; either
 * version 2 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Library General Public License for more details.
 *
 * You should have received a copy of the GNU Library General Public License
 * along with this library; see the file COPYING.LIB. If not, write to
 * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 * Boston, MA 02110-1301, USA.
 */

#ifndef EWSREPLY_H
#define EWSREPLY_H

#include "ewsexport.h"
#include "EwsRequest.h"

#include <QNetworkReply>

class EwsConnection;
class EwsReplyPrivate;
class EWS_EXPORT EwsReply : public QObject
{
    Q_OBJECT
    Q_ENUMS(ResponseCode)
public:
    enum ResponseCode {
        NoError,
        ErrorAccessDenied,
        ErrorAccessModeSpecified,
        ErrorAccountDisabled,
        ErrorAddDelegatesFailed,
        ErrorAddressSpaceNotFound,
        ErrorADOperation,
        ErrorADSessionFilter,
        ErrorADUnavailable,
        ErrorAffectedTaskOccurrencesRequired,
        ErrorArchiveFolderPathCreation,
        ErrorArchiveMailboxNotEnabled,
        ErrorArchiveMailboxServiceDiscoveryFailed,
        ErrorAttachmentNestLevelLimitExceeded,
        ErrorAttachmentSizeLimitExceeded,
        ErrorAutoDiscoverFailed,
        ErrorAvailabilityConfigNotFound,
        ErrorBatchProcessingStopped,
        ErrorCalendarCannotMoveOrCopyOccurrence,
        ErrorCalendarCannotUpdateDeletedItem,
        ErrorCalendarCannotUseIdForOccurrenceId,
        ErrorCalendarCannotUseIdForRecurringMasterId,
        ErrorCalendarDurationIsTooLong,
        ErrorCalendarEndDateIsEarlierThanStartDate,
        ErrorCalendarFolderIsInvalidForCalendarView,
        ErrorCalendarInvalidAttributeValue,
        ErrorCalendarInvalidDayForTimeChangePattern,
        ErrorCalendarInvalidDayForWeeklyRecurrence,
        ErrorCalendarInvalidPropertyState,
        ErrorCalendarInvalidPropertyValue,
        ErrorCalendarInvalidRecurrence,
        ErrorCalendarInvalidTimeZone,
        ErrorCalendarIsCancelledForAccept,
        ErrorCalendarIsCancelledForDecline,
        ErrorCalendarIsCancelledForRemove,
        ErrorCalendarIsCancelledForTentative,
        ErrorCalendarIsDelegatedForAccept,
        ErrorCalendarIsDelegatedForDecline,
        ErrorCalendarIsDelegatedForRemove,
        ErrorCalendarIsDelegatedForTentative,
        ErrorCalendarIsNotOrganizer,
        ErrorCalendarIsOrganizerForAccept,
        ErrorCalendarIsOrganizerForDecline,
        ErrorCalendarIsOrganizerForRemove,
        ErrorCalendarIsOrganizerForTentative,
        ErrorCalendarMeetingRequestIsOutOfDate,
        ErrorCalendarOccurrenceIndexIsOutOfRecurrenceRange,
        ErrorCalendarOccurrenceIsDeletedFromRecurrence,
        ErrorCalendarOutOfRange,
        ErrorCalendarViewRangeTooBig,
        ErrorCallerIsInvalidADAccount,
        ErrorCannotArchiveCalendarContactTaskFolderException,
        ErrorCannotArchiveItemsInPublicFolders,
        ErrorCannotArchiveItemsInArchiveMailbo,
        ErrorCannotCreateCalendarItemInNonCalendarFolder,
        ErrorCannotCreateContactInNonContactFolder,
        ErrorCannotCreatePostItemInNonMailFolder,
        ErrorCannotCreateTaskInNonTaskFolder,
        ErrorCannotDeleteObject,
        ErrorCannotDeleteTaskOccurrence,
        ErrorCannotDisableMandatoryExtension,
        ErrorCannotEmptyFolder,
        ErrorCannotGetSourceFolderPath,
        ErrorCannotGetExternalEcpUrl,
        ErrorCannotOpenFileAttachment,
        ErrorCannotSetCalendarPermissionOnNonCalendarFolder,
        ErrorCannotSetNonCalendarPermissionOnCalendarFolder,
        ErrorCannotSetPermissionUnknownEntries,
        ErrorCannotSpecifySearchFolderAsSourceFolder,
        ErrorCannotUseFolderIdForItemId,
        ErrorCannotUseItemIdForFolderId,
        ErrorChangeKeyRequired,
        ErrorChangeKeyRequiredForWriteOperations,
        ErrorClientDisconnected,
        ErrorClientIntentInvalidStateDefinition,
        ErrorClientIntentNotFound,
        ErrorConnectionFailed,
        ErrorContainsFilterWrongType,
        ErrorContentConversionFailed,
        ErrorContentIndexingNotEnabled,
        ErrorCorruptData,
        ErrorCreateItemAccessDenied,
        ErrorCreateManagedFolderPartialCompletion,
        ErrorCreateSubfolderAccessDenied,
        ErrorCrossMailboxMoveCopy,
        ErrorCrossSiteRequest,
        ErrorDataSizeLimitExceeded,
        ErrorDataSourceOperation,
        ErrorDelegateAlreadyExists,
        ErrorDelegateCannotAddOwner,
        ErrorDelegateMissingConfiguration,
        ErrorDelegateNoUser,
        ErrorDelegateValidationFailed,
        ErrorDeleteDistinguishedFolder,
        ErrorDeleteItemsFailed,
        ErrorDeleteUnifiedMessagingPromptFailed,
        ErrorDistinguishedUserNotSupported,
        ErrorDistributionListMemberNotExist,
        ErrorDuplicateInputFolderNames,
        ErrorDuplicateSOAPHeader,
        ErrorDuplicateUserIdsSpecified,
        ErrorEmailAddressMismatch,
        ErrorEventNotFound,
        ErrorExceededConnectionCount,
        ErrorExceededSubscriptionCount,
        ErrorExceededFindCountLimit,
        ErrorExpiredSubscription,
        ErrorExtensionNotFound,
        ErrorFolderCorrupt,
        ErrorFolderExists,
        ErrorFolderNotFound,
        ErrorFolderPropertRequestFailed,
        ErrorFolderSave,
        ErrorFolderSaveFailed,
        ErrorFolderSavePropertyError,
        ErrorFreeBusyDLLimitReached,
        ErrorFreeBusyGenerationFailed,
        ErrorGetServerSecurityDescriptorFailed,
        ErrorImContactLimitReached,
        ErrorImGroupDisplayNameAlreadyExists,
        ErrorImGroupLimitReached,
        ErrorImpersonateUserDenied,
        ErrorImpersonationDenied,
        ErrorImpersonationFailed,
        ErrorIncorrectSchemaVersion,
        ErrorIncorrectUpdatePropertyCount,
        ErrorIndividualMailboxLimitReached,
        ErrorInsufficientResources,
        ErrorInternalServerError,
        ErrorInternalServerTransientError,
        ErrorInvalidAccessLevel,
        ErrorInvalidArgument,
        ErrorInvalidAttachmentId,
        ErrorInvalidAttachmentSubfilter,
        ErrorInvalidAttachmentSubfilterTextFilter,
        ErrorInvalidAuthorizationContext,
        ErrorInvalidChangeKey,
        ErrorInvalidClientSecurityContext,
        ErrorInvalidCompleteDate,
        ErrorInvalidContactEmailAddress,
        ErrorInvalidContactEmailIndex,
        ErrorInvalidCrossForestCredentials,
        ErrorInvalidDelegatePermission,
        ErrorInvalidDelegateUserId,
        ErrorInvalidExchangeImpersonationHeaderData,
        ErrorInvalidExcludesRestriction,
        ErrorInvalidExpressionTypeForSubFilter,
        ErrorInvalidExtendedProperty,
        ErrorInvalidExtendedPropertyValue,
        ErrorInvalidExternalSharingInitiator,
        ErrorInvalidExternalSharingSubscriber,
        ErrorInvalidFederatedOrganizationId,
        ErrorInvalidFolderId,
        ErrorInvalidFolderTypeForOperation,
        ErrorInvalidFractionalPagingParameters,
        ErrorInvalidGetSharingFolderRequest,
        ErrorInvalidFreeBusyViewType,
        ErrorInvalidId,
        ErrorInvalidIdEmpty,
        ErrorInvalidIdMalformed,
        ErrorInvalidIdMalformedEwsLegacyIdFormat,
        ErrorInvalidIdMonikerTooLong,
        ErrorInvalidIdNotAnItemAttachmentId,
        ErrorInvalidIdReturnedByResolveNames,
        ErrorInvalidIdStoreObjectIdTooLong,
        ErrorInvalidIdTooManyAttachmentLevels,
        ErrorInvalidIdXml,
        ErrorInvalidImContactId,
        ErrorInvalidImDistributionGroupSmtpAddress,
        ErrorInvalidImGroupId,
        ErrorInvalidIndexedPagingParameters,
        ErrorInvalidInternetHeaderChildNodes,
        ErrorInvalidItemForOperationArchiveItem,
        ErrorInvalidItemForOperationAcceptItem,
        ErrorInvalidItemForOperationCancelItem,
        ErrorInvalidItemForOperationCreateItemAttachment,
        ErrorInvalidItemForOperationCreateItem,
        ErrorInvalidItemForOperationDeclineItem,
        ErrorInvalidItemForOperationExpandDL,
        ErrorInvalidItemForOperationRemoveItem,
        ErrorInvalidItemForOperationSendItem,
        ErrorInvalidItemForOperationTentative,
        ErrorInvalidLogonType,
        ErrorInvalidMailbox,
        ErrorInvalidManagedFolderProperty,
        ErrorInvalidManagedFolderQuota,
        ErrorInvalidManagedFolderSize,
        ErrorInvalidMergedFreeBusyInterval,
        ErrorInvalidNameForNameResolution,
        ErrorInvalidNetworkServiceContext,
        ErrorInvalidOofParameter,
        ErrorInvalidOperation,
        ErrorInvalidOrganizationRelationshipForFreeBusy,
        ErrorInvalidPagingMaxRows,
        ErrorInvalidParentFolder,
        ErrorInvalidPercentCompleteValue,
        ErrorInvalidPermissionSettings,
        ErrorInvalidPhoneCallId,
        ErrorInvalidPhoneNumber,
        ErrorInvalidPropertyAppend,
        ErrorInvalidPropertyDelete,
        ErrorInvalidPropertyForExists,
        ErrorInvalidPropertyForOperation,
        ErrorInvalidPropertyRequest,
        ErrorInvalidPropertySet,
        ErrorInvalidPropertyUpdateSentMessage,
        ErrorInvalidProxySecurityContext,
        ErrorInvalidPullSubscriptionId,
        ErrorInvalidPushSubscriptionUrl,
        ErrorInvalidRecipients,
        ErrorInvalidRecipientSubfilter,
        ErrorInvalidRecipientSubfilterComparison,
        ErrorInvalidRecipientSubfilterOrder,
        ErrorInvalidRecipientSubfilterTextFilter,
        ErrorInvalidReferenceItem,
        ErrorInvalidRequest,
        ErrorInvalidRestriction,
        ErrorInvalidRetentionTagTypeMismatch,
        ErrorInvalidRetentionTagInvisible,
        ErrorInvalidRetentionTagInheritance,
        ErrorInvalidRetentionTagIdGuid,
        ErrorInvalidRoutingType,
        ErrorInvalidScheduledOofDuration,
        ErrorInvalidSchemaVersionForMailboxVersion,
        ErrorInvalidSecurityDescriptor,
        ErrorInvalidSendItemSaveSettings,
        ErrorInvalidSerializedAccessToken,
        ErrorInvalidSharingData,
        ErrorInvalidSharingMessage,
        ErrorInvalidSid,
        ErrorInvalidSIPUri,
        ErrorInvalidServerVersion,
        ErrorInvalidSmtpAddress,
        ErrorInvalidSubfilterType,
        ErrorInvalidSubfilterTypeNotAttendeeType,
        ErrorInvalidSubfilterTypeNotRecipientType,
        ErrorInvalidSubscription,
        ErrorInvalidSubscriptionRequest,
        ErrorInvalidSyncStateData,
        ErrorInvalidTimeInterval,
        ErrorInvalidUserInfo,
        ErrorInvalidUserOofSettings,
        ErrorInvalidUserPrincipalName,
        ErrorInvalidUserSid,
        ErrorInvalidUserSidMissingUPN,
        ErrorInvalidValueForProperty,
        ErrorInvalidWatermark,
        ErrorIPGatewayNotFound,
        ErrorIrresolvableConflict,
        ErrorItemCorrupt,
        ErrorItemNotFound,
        ErrorItemPropertyRequestFailed,
        ErrorItemSave,
        ErrorItemSavePropertyError,
        ErrorLegacyMailboxFreeBusyViewTypeNotMerged,
        ErrorLocalServerObjectNotFound,
        ErrorLogonAsNetworkServiceFailed,
        ErrorMailboxConfiguration,
        ErrorMailboxDataArrayEmpty,
        ErrorMailboxDataArrayTooBig,
        ErrorMailboxFailover,
        ErrorMailboxHoldNotFound,
        ErrorMailboxLogonFailed,
        ErrorMailboxMoveInProgress,
        ErrorMailboxStoreUnavailable,
        ErrorMailRecipientNotFound,
        ErrorMailTipsDisabled,
        ErrorManagedFolderAlreadyExists,
        ErrorManagedFolderNotFound,
        ErrorManagedFoldersRootFailure,
        ErrorMeetingSuggestionGenerationFailed,
        ErrorMessageDispositionRequired,
        ErrorMessageSizeExceeded,
        ErrorMessageTrackingNoSuchDomain,
        ErrorMessageTrackingPermanentError,
        ErrorMessageTrackingTransientError,
        ErrorMimeContentConversionFailed,
        ErrorMimeContentInvalid,
        ErrorMimeContentInvalidBase64String,
        ErrorMissingArgument,
        ErrorMissingEmailAddress,
        ErrorMissingEmailAddressForManagedFolder,
        ErrorMissingInformationEmailAddress,
        ErrorMissingInformationReferenceItemId,
        ErrorMissingInformationSharingFolderId,
        ErrorMissingItemForCreateItemAttachment,
        ErrorMissingManagedFolderId,
        ErrorMissingRecipients,
        ErrorMissingUserIdInformation,
        ErrorMoreThanOneAccessModeSpecified,
        ErrorMoveCopyFailed,
        ErrorMoveDistinguishedFolder,
        ErrorMultiLegacyMailboxAccess,
        ErrorNameResolutionMultipleResults,
        ErrorNameResolutionNoMailbox,
        ErrorNameResolutionNoResults,
        ErrorNoApplicableProxyCASServersAvailable,
        ErrorNoCalendar,
        ErrorNoDestinationCASDueToKerberosRequirements,
        ErrorNoDestinationCASDueToSSLRequirements,
        ErrorNoDestinationCASDueToVersionMismatch,
        ErrorNoFolderClassOverride,
        ErrorNoFreeBusyAccess,
        ErrorNonExistentMailbox,
        ErrorNonPrimarySmtpAddress,
        ErrorNoPropertyTagForCustomProperties,
        ErrorNoPublicFolderReplicaAvailable,
        ErrorNoPublicFolderServerAvailable,
        ErrorNoRespondingCASInDestinationSite,
        ErrorNotAllowedExternalSharingByPolicy,
        ErrorNotDelegate,
        ErrorNotEnoughMemory,
        ErrorNotSupportedSharingMessage,
        ErrorObjectTypeChanged,
        ErrorOccurrenceCrossingBoundary,
        ErrorOccurrenceTimeSpanTooBig,
        ErrorOperationNotAllowedWithPublicFolderRoot,
        ErrorOrganizationNotFederated,
        ErrorParentFolderIdRequired,
        ErrorParentFolderNotFound,
        ErrorPasswordChangeRequired,
        ErrorPasswordExpired,
        ErrorPermissionNotAllowedByPolicy,
        ErrorPhoneNumberNotDialable,
        ErrorPropertyUpdate,
        ErrorPromptPublishingOperationFailed,
        ErrorPropertyValidationFailure,
        ErrorProxiedSubscriptionCallFailure,
        ErrorProxyCallFailed,
        ErrorProxyGroupSidLimitExceeded,
        ErrorProxyRequestNotAllowed,
        ErrorProxyRequestProcessingFailed,
        ErrorProxyServiceDiscoveryFailed,
        ErrorProxyTokenExpired,
        ErrorPublicFolderMailboxDiscoveryFailed,
        ErrorPublicFolderOperationFailed,
        ErrorPublicFolderRequestProcessingFailed,
        ErrorPublicFolderServerNotFound,
        ErrorPublicFolderSyncException,
        ErrorQueryFilterTooLong,
        ErrorQuotaExceeded,
        ErrorReadEventsFailed,
        ErrorReadReceiptNotPending,
        ErrorRecurrenceEndDateTooBig,
        ErrorRecurrenceHasNoOccurrence,
        ErrorRemoveDelegatesFailed,
        ErrorRequestAborted,
        ErrorRequestStreamTooBig,
        ErrorRequiredPropertyMissing,
        ErrorResolveNamesInvalidFolderType,
        ErrorResolveNamesOnlyOneContactsFolderAllowed,
        ErrorResponseSchemaValidation,
        ErrorRestrictionTooLong,
        ErrorRestrictionTooComplex,
        ErrorResultSetTooBig,
        ErrorSavedItemFolderNotFound,
        ErrorSchemaValidation,
        ErrorSearchFolderNotInitialized,
        ErrorSendAsDenied,
        ErrorSendMeetingCancellationsRequired,
        ErrorSendMeetingInvitationsOrCancellationsRequired,
        ErrorSendMeetingInvitationsRequired,
        ErrorSentMeetingRequestUpdate,
        ErrorSentTaskRequestUpdate,
        ErrorServerBusy,
        ErrorServiceDiscoveryFailed,
        ErrorSharingNoExternalEwsAvailable,
        ErrorSharingSynchronizationFailed,
        ErrorStaleObject,
        ErrorSubmissionQuotaExceeded,
        ErrorSubscriptionAccessDenied,
        ErrorSubscriptionDelegateAccessNotSupported,
        ErrorSubscriptionNotFound,
        ErrorSubscriptionUnsubsribed,
        ErrorSyncFolderNotFound,
        ErrorTeamMailboxNotFound,
        ErrorTeamMailboxNotLinkedToSharePoint,
        ErrorTeamMailboxUrlValidationFailed,
        ErrorTeamMailboxNotAuthorizedOwner,
        ErrorTeamMailboxActiveToPendingDelete,
        ErrorTeamMailboxFailedSendingNotifications,
        ErrorTeamMailboxErrorUnknown,
        ErrorTimeIntervalTooBig,
        ErrorTimeoutExpired,
        ErrorTimeZone,
        ErrorToFolderNotFound,
        ErrorTokenSerializationDenied,
        ErrorUnifiedMessagingDialPlanNotFound,
        ErrorUnifiedMessagingReportDataNotFound,
        ErrorUnifiedMessagingPromptNotFound,
        ErrorUnifiedMessagingRequestFailed,
        ErrorUnifiedMessagingServerNotFound,
        ErrorUnableToGetUserOofSettings,
        ErrorUnableToRemoveImContactFromGroup,
        ErrorUnsupportedCulture,
        ErrorUnsupportedMapiPropertyType,
        ErrorUnsupportedMimeConversion,
        ErrorUnsupportedPathForQuery,
        ErrorUnsupportedPathForSortGroup,
        ErrorUnsupportedPropertyDefinition,
        ErrorUnsupportedQueryFilter,
        ErrorUnsupportedRecurrence,
        ErrorUnsupportedSubFilter,
        ErrorUnsupportedTypeForConversion,
        ErrorUpdateDelegatesFailed,
        ErrorUpdatePropertyMismatch,
        ErrorUserNotUnifiedMessagingEnabled,
        ErrorUserNotAllowedByPolicy,
        ErrorUserWithoutFederatedProxyAddress,
        ErrorValueOutOfRange,
        ErrorVirusDetected,
        ErrorVirusMessageDeleted,
        ErrorVoiceMailNotImplemented,
        ErrorWebRequestInInvalidState,
        ErrorWin32InteropError,
        ErrorWorkingHoursSaveFailed,
        ErrorWorkingHoursXmlMalformed,
        ErrorWrongServerVersion,
        ErrorWrongServerVersionDelegate,
        ErrorApplyConversationActionFailed,
        ErrorInboxRulesValidationError,
        ErrorOutlookRuleBlobExists,
        ErrorRulesOverQuota,
        ErrorNewEventStreamConnectionOpened,
        ErrorMissedNotificationEvents,
        ErrorDuplicateLegacyDistinguishedName,
        ErrorInvalidClientAccessTokenRequest,
        ErrorNoSpeechDetected,
        ErrorUMServerUnavailable,
        ErrorRecipientNotFound,
        ErrorRecognizerNotInstalled,
        ErrorSpeechGrammarError,
        ErrorInvalidManagementRoleHeader,
        ErrorLocationServicesDisabled,
        ErrorLocationServicesRequestTimedOut,
        ErrorLocationServicesRequestFailed,
        ErrorLocationServicesInvalidRequest,
        ErrorMailboxScopeNotAllowedWithoutQueryString,
        ErrorArchiveMailboxSearchFailed,
        ErrorInvalidPhotoSize,
        ErrorSearchQueryHasTooManyKeywords,
        ErrorSearchTooManyMailboxes,
        ErrorInvalidRetentionTagNone,
        ErrorDiscoverySearchesDisabled
    };
    EwsReply(void *job);
    ~EwsReply();

    void setReply(QNetworkReply *reply);
    bool error() const;
    ResponseCode responseCode() const;
    QString errorMessage() const;

signals:
    void finished();

private:
    friend class EwsConnection;
    Q_DECLARE_PRIVATE(EwsReply)
    EwsReplyPrivate *d_ptr;
};

#endif // EWSREPLY_H
